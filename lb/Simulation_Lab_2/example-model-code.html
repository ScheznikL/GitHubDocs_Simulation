<pre><font color="#007f69">globals</font><font color="#000000"> [<br />  sample-car<br />  bad-drivers-count<br />]<br /><br /></font><font color="#007f69">turtles-own</font><font color="#000000"> [<br />  speed<br />  speed-limit<br />  speed-min<br />  is-bad<br />]<br /><br /></font><font color="#007f69">to</font><font color="#000000"> setup<br />  </font><font color="#0000aa">clear-all</font><font color="#000000"><br />  </font><font color="#0000aa">ask</font><font color="#000000"> </font><font color="#660096">patches</font><font color="#000000"> [ setup-road ]<br />  setup-cars<br />  </font><font color="#0000aa">watch</font><font color="#000000"> sample-car<br />  </font><font color="#0000aa">reset-ticks</font><font color="#000000"><br /></font><font color="#007f69">end</font><font color="#000000"><br /><br /></font><font color="#007f69">to</font><font color="#000000"> setup-road </font><font color="#5a5a5a">;; patch procedure</font><font color="#000000"><br />  </font><font color="#0000aa">if</font><font color="#000000"> </font><font color="#660096">pycor</font><font color="#000000"> </font><font color="#660096">=</font><font color="#000000"> </font><font color="#963700">-1</font><font color="#000000"> [ </font><font color="#0000aa">set</font><font color="#000000"> </font><font color="#660096">pcolor</font><font color="#000000"> </font><font color="#963700">yellow</font><font color="#000000"> ]<br />  </font><font color="#0000aa">if</font><font color="#000000"> </font><font color="#660096">pycor</font><font color="#000000"> </font><font color="#660096">=</font><font color="#000000"> </font><font color="#963700">0</font><font color="#000000"> [ </font><font color="#0000aa">set</font><font color="#000000"> </font><font color="#660096">pcolor</font><font color="#000000"> </font><font color="#963700">white</font><font color="#000000"> ]<br /></font><font color="#007f69">end</font><font color="#000000"><br /><br /></font><font color="#007f69">to</font><font color="#000000"> setup-cars<br />  </font><font color="#0000aa">if</font><font color="#000000"> number-of-cars </font><font color="#660096">&gt;</font><font color="#000000"> </font><font color="#660096">world-width</font><font color="#000000"> [<br />    </font><font color="#0000aa">user-message</font><font color="#000000"> (</font><font color="#660096">word</font><font color="#000000"><br />      </font><font color="#963700">&quot;There are too many cars for the amount of road. &quot;</font><font color="#000000"><br />      </font><font color="#963700">&quot;Please decrease the NUMBER-OF-CARS slider to below &quot;</font><font color="#000000"><br />      (</font><font color="#660096">world-width</font><font color="#000000"> </font><font color="#660096">+</font><font color="#000000"> </font><font color="#963700">1</font><font color="#000000">) </font><font color="#963700">&quot; and press the SETUP button again. &quot;</font><font color="#000000"><br />      </font><font color="#963700">&quot;The setup has stopped.&quot;</font><font color="#000000">)<br />    </font><font color="#0000aa">stop</font><font color="#000000"><br />  ]<br />  </font><font color="#0000aa">set-default-shape</font><font color="#000000"> </font><font color="#660096">turtles</font><font color="#000000"> </font><font color="#963700">&quot;car&quot;</font><font color="#000000"><br />  </font><font color="#0000aa">create-turtles</font><font color="#000000"> number-of-cars [<br />    </font><font color="#0000aa">set</font><font color="#000000"> </font><font color="#660096">color</font><font color="#000000"> </font><font color="#963700">blue</font><font color="#000000"><br />    </font><font color="#5a5a5a">;;set xcor abs random-xcor</font><font color="#000000"><br />    set-freeposition<br />    </font><font color="#0000aa">set</font><font color="#000000"> </font><font color="#660096">heading</font><font color="#000000"> </font><font color="#963700">90</font><font color="#000000"><br />    </font><font color="#5a5a5a">;; set initial speed to be in range 0.1 to 1.0</font><font color="#000000"><br />    </font><font color="#5a5a5a">;;set speed 0.1 + random-float 1.9</font><font color="#000000"><br />    </font><font color="#0000aa">set</font><font color="#000000"> speed get-random-float </font><font color="#963700">0.1</font><font color="#000000"> </font><font color="#963700">1</font><font color="#000000"><br />    </font><font color="#5a5a5a">;; set speed-limit 2</font><font color="#000000"><br />    </font><font color="#0000aa">set</font><font color="#000000"> speed-limit get-random-float </font><font color="#963700">1.1</font><font color="#000000"> </font><font color="#963700">0.9</font><font color="#000000"><br />    </font><font color="#5a5a5a">;; set label speed-limit</font><font color="#000000"><br />    </font><font color="#0000aa">if</font><font color="#000000"> (speed-limit </font><font color="#660096">&gt;</font><font color="#000000"> </font><font color="#963700">1.2</font><font color="#000000">) [<br />      </font><font color="#0000aa">set</font><font color="#000000"> </font><font color="#660096">color</font><font color="#000000"> </font><font color="#963700">green</font><font color="#000000"><br />    ]<br />    </font><font color="#0000aa">if</font><font color="#000000"> (speed-limit </font><font color="#660096">&gt;</font><font color="#000000"> </font><font color="#963700">1.5</font><font color="#000000">) [<br />      </font><font color="#0000aa">set</font><font color="#000000"> </font><font color="#660096">color</font><font color="#000000"> </font><font color="#963700">orange</font><font color="#000000"><br />    ]<br />    </font><font color="#0000aa">set</font><font color="#000000"> speed-min </font><font color="#963700">0</font><font color="#000000"><br />    <br />    </font><font color="#0000aa">let</font><font color="#000000"> prob </font><font color="#660096">random</font><font color="#000000"> </font><font color="#963700">100</font><font color="#000000"><br />    </font><font color="#0000aa">ifelse</font><font color="#000000"> (prob </font><font color="#660096">&lt;</font><font color="#000000"> bad-driver-probability) [<br />      </font><font color="#0000aa">set</font><font color="#000000"> is-bad </font><font color="#963700">true</font><font color="#000000"><br />    ]<br />    [<br />      </font><font color="#0000aa">set</font><font color="#000000"> is-bad </font><font color="#963700">false</font><font color="#000000"><br />    ]<br />  ]<br />  </font><font color="#0000aa">set</font><font color="#000000"> sample-car </font><font color="#660096">one-of</font><font color="#000000"> </font><font color="#660096">turtles</font><font color="#000000"><br />  </font><font color="#5a5a5a">;; ask sample-car [ set color red ]</font><font color="#000000"><br />  <br />  </font><font color="#0000aa">set</font><font color="#000000"> bad-drivers-count </font><font color="#963700">0</font><font color="#000000"><br /></font><font color="#007f69">end</font><font color="#000000"><br /><br /></font><font color="#007f69">to</font><font color="#000000"> set-freeposition<br />  </font><font color="#0000aa">set</font><font color="#000000"> </font><font color="#660096">xcor</font><font color="#000000"> </font><font color="#660096">random-pxcor</font><font color="#000000"><br />  </font><font color="#0000aa">if</font><font color="#000000"> </font><font color="#660096">any?</font><font color="#000000"> </font><font color="#660096">other</font><font color="#000000"> </font><font color="#660096">turtles-here</font><font color="#000000"> [ set-freeposition ]<br /></font><font color="#007f69">end</font><font color="#000000"><br /><br /></font><font color="#007f69">to-report</font><font color="#000000"> get-random-float [low high]<br />  </font><font color="#0000aa">report</font><font color="#000000"> low </font><font color="#660096">+</font><font color="#000000"> </font><font color="#660096">random-float</font><font color="#000000"> high<br /></font><font color="#007f69">end</font><font color="#000000"><br /><br /></font><font color="#007f69">to</font><font color="#000000"> go<br />  </font><font color="#5a5a5a">;; if there is a car right ahead of you, match its speed then slow down</font><font color="#000000"><br />  </font><font color="#0000aa">ask</font><font color="#000000"> </font><font color="#660096">turtles</font><font color="#000000"> [<br />    <br />    </font><font color="#0000aa">if</font><font color="#000000"> (</font><font color="#660096">pycor</font><font color="#000000"> </font><font color="#660096">!=</font><font color="#000000"> </font><font color="#963700">0</font><font color="#000000">) [<br />      </font><font color="#0000aa">if</font><font color="#000000"> (is-road-main-free </font><font color="#660096">=</font><font color="#000000"> </font><font color="#963700">true</font><font color="#000000">) [<br />        </font><font color="#0000aa">set</font><font color="#000000"> </font><font color="#660096">heading</font><font color="#000000"> </font><font color="#963700">0</font><font color="#000000"><br />        </font><font color="#0000aa">fd</font><font color="#000000"> </font><font color="#963700">1</font><font color="#000000"><br />        </font><font color="#0000aa">set</font><font color="#000000"> </font><font color="#660096">heading</font><font color="#000000"> </font><font color="#963700">90</font><font color="#000000"><br />        </font><font color="#0000aa">set</font><font color="#000000"> bad-drivers-count bad-drivers-count </font><font color="#660096">-</font><font color="#000000"> </font><font color="#963700">1</font><font color="#000000"><br />      ]<br />    ]<br />    <br />    </font><font color="#0000aa">let</font><font color="#000000"> car-ahead </font><font color="#660096">one-of</font><font color="#000000"> </font><font color="#660096">turtles-on</font><font color="#000000"> </font><font color="#660096">patch-ahead</font><font color="#000000"> </font><font color="#963700">1</font><font color="#000000"><br />    </font><font color="#0000aa">let</font><font color="#000000"> car-ahead-2 </font><font color="#660096">one-of</font><font color="#000000"> </font><font color="#660096">turtles-on</font><font color="#000000"> </font><font color="#660096">patch-ahead</font><font color="#000000"> </font><font color="#963700">2</font><font color="#000000"><br />    </font><font color="#0000aa">ifelse</font><font color="#000000"> (car-ahead </font><font color="#660096">=</font><font color="#000000"> </font><font color="#963700">nobody</font><font color="#000000">) </font><font color="#660096">and</font><font color="#000000"> (car-ahead-2 </font><font color="#660096">=</font><font color="#000000"> </font><font color="#963700">nobody</font><font color="#000000">)<br />      [ speed-up-car ]<br />      [ slow-down-car car-ahead car-ahead-2 ]<br />    </font><font color="#5a5a5a">;; don't slow down below speed minimum or speed up beyond speed limit</font><font color="#000000"><br />    </font><font color="#0000aa">if</font><font color="#000000"> speed </font><font color="#660096">&lt;</font><font color="#000000"> speed-min [ </font><font color="#0000aa">set</font><font color="#000000"> speed speed-min ]<br />    </font><font color="#0000aa">if</font><font color="#000000"> speed </font><font color="#660096">&gt;</font><font color="#000000"> speed-limit [ </font><font color="#0000aa">set</font><font color="#000000"> speed speed-limit ]<br />    </font><font color="#0000aa">fd</font><font color="#000000"> speed<br />  ]<br />  </font><font color="#0000aa">tick</font><font color="#000000"><br /></font><font color="#007f69">end</font><font color="#000000"><br /><br /></font><font color="#007f69">to</font><font color="#000000"> slow-down-car [ car-ahead car-ahead-2 ] </font><font color="#5a5a5a">;; turtle procedure</font><font color="#000000"><br />  </font><font color="#0000aa">if</font><font color="#000000"> (car-ahead </font><font color="#660096">=</font><font color="#000000"> </font><font color="#963700">nobody</font><font color="#000000">) </font><font color="#660096">and</font><font color="#000000"> (car-ahead-2 </font><font color="#660096">!=</font><font color="#000000"> </font><font color="#963700">nobody</font><font color="#000000">) [<br />    </font><font color="#0000aa">let</font><font color="#000000"> speed-car-ahead-2 [ speed ] </font><font color="#660096">of</font><font color="#000000"> car-ahead-2<br />    </font><font color="#0000aa">let</font><font color="#000000"> speed-difference-ahead-2 </font><font color="#660096">abs</font><font color="#000000"> speed </font><font color="#660096">-</font><font color="#000000"> speed-car-ahead-2<br />    </font><font color="#0000aa">set</font><font color="#000000"> speed speed </font><font color="#660096">-</font><font color="#000000"> speed-difference-ahead-2 </font><font color="#660096">/</font><font color="#000000"> </font><font color="#963700">2</font><font color="#000000"><br />  ]<br />  </font><font color="#0000aa">if</font><font color="#000000"> (car-ahead </font><font color="#660096">!=</font><font color="#000000"> </font><font color="#963700">nobody</font><font color="#000000">) [<br />    </font><font color="#0000aa">ifelse</font><font color="#000000"> (is-bad </font><font color="#660096">=</font><font color="#000000"> </font><font color="#963700">true</font><font color="#000000">) </font><font color="#660096">AND</font><font color="#000000"> (</font><font color="#660096">pycor</font><font color="#000000"> </font><font color="#660096">=</font><font color="#000000"> </font><font color="#963700">0</font><font color="#000000">) [<br />      </font><font color="#0000aa">if</font><font color="#000000"> (is-roadside-free </font><font color="#660096">=</font><font color="#000000"> </font><font color="#963700">true</font><font color="#000000">) [<br />        </font><font color="#0000aa">set</font><font color="#000000"> </font><font color="#660096">heading</font><font color="#000000"> </font><font color="#963700">180</font><font color="#000000"><br />        </font><font color="#0000aa">fd</font><font color="#000000"> </font><font color="#963700">1</font><font color="#000000"><br />        </font><font color="#0000aa">set</font><font color="#000000"> </font><font color="#660096">heading</font><font color="#000000"> </font><font color="#963700">90</font><font color="#000000"><br />        </font><font color="#0000aa">set</font><font color="#000000"> bad-drivers-count bad-drivers-count </font><font color="#660096">+</font><font color="#000000"> </font><font color="#963700">1</font><font color="#000000"><br />      ]<br />    ]<br />    [ <br />      </font><font color="#5a5a5a">;; slow down so you are driving more slowly than the car ahead of you</font><font color="#000000"><br />      </font><font color="#0000aa">let</font><font color="#000000"> speed-car-ahead [ speed ] </font><font color="#660096">of</font><font color="#000000"> car-ahead<br />      </font><font color="#0000aa">set</font><font color="#000000"> speed speed-car-ahead </font><font color="#660096">-</font><font color="#000000"> deceleration<br />    ]<br />  ]<br /></font><font color="#007f69">end</font><font color="#000000"><br /><br /></font><font color="#007f69">to</font><font color="#000000"> speed-up-car </font><font color="#5a5a5a">;; turtle procedure</font><font color="#000000"><br />  </font><font color="#0000aa">set</font><font color="#000000"> speed speed </font><font color="#660096">+</font><font color="#000000"> acceleration<br /></font><font color="#007f69">end</font><font color="#000000"><br /><br /></font><font color="#007f69">to-report</font><font color="#000000"> is-roadside-free<br />  </font><font color="#0000aa">set</font><font color="#000000"> </font><font color="#660096">heading</font><font color="#000000"> </font><font color="#963700">180</font><font color="#000000"><br />  </font><font color="#0000aa">let</font><font color="#000000"> car-roadside </font><font color="#660096">one-of</font><font color="#000000"> </font><font color="#660096">turtles-on</font><font color="#000000"> </font><font color="#660096">patch-ahead</font><font color="#000000"> </font><font color="#963700">1</font><font color="#000000"><br />  </font><font color="#0000aa">ifelse</font><font color="#000000"> (car-roadside </font><font color="#660096">=</font><font color="#000000"> </font><font color="#963700">nobody</font><font color="#000000">) [<br />    </font><font color="#0000aa">set</font><font color="#000000"> </font><font color="#660096">heading</font><font color="#000000"> </font><font color="#963700">90</font><font color="#000000"><br />    </font><font color="#0000aa">report</font><font color="#000000"> </font><font color="#963700">true</font><font color="#000000"><br />  ]<br />  [<br />    </font><font color="#0000aa">set</font><font color="#000000"> </font><font color="#660096">heading</font><font color="#000000"> </font><font color="#963700">90</font><font color="#000000"><br />    </font><font color="#0000aa">report</font><font color="#000000"> </font><font color="#963700">false</font><font color="#000000"><br />  ]<br /></font><font color="#007f69">end</font><font color="#000000"><br /><br /></font><font color="#007f69">to-report</font><font color="#000000"> is-road-main-free  <br />  </font><font color="#0000aa">let</font><font color="#000000"> cars-near-amount </font><font color="#660096">count</font><font color="#000000"> </font><font color="#660096">turtles-on</font><font color="#000000"> </font><font color="#660096">neighbors</font><font color="#000000"><br />  </font><font color="#0000aa">if</font><font color="#000000"> (cars-near-amount </font><font color="#660096">=</font><font color="#000000"> </font><font color="#963700">0</font><font color="#000000">) [<br />    </font><font color="#0000aa">report</font><font color="#000000"> </font><font color="#963700">true</font><font color="#000000"><br />  ]<br />  </font><font color="#0000aa">report</font><font color="#000000"> </font><font color="#963700">false</font><font color="#000000"><br /></font><font color="#007f69">end</font><font color="#000000"><br /><br /><br /></font><font color="#5a5a5a">; Copyright 1997 Uri Wilensky.</font><font color="#000000"><br /></font><font color="#5a5a5a">; See Info tab for full copyright and license.</font>
</pre>
